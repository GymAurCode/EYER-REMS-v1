# XLSX Vulnerability Fix

## Issue
The `xlsx` package (version 0.18.5) had high severity vulnerabilities:
- **Prototype Pollution in sheetJS** (GHSA-4r6h-8v6p-xvw6)
- **SheetJS Regular Expression Denial of Service (ReDoS)** (GHSA-5pgg-2g8v-p4x9)

## Solution
The `xlsx` package was **removed** from dependencies because:

1. **Not Actually Used**: The package was listed in `package.json` but not imported or used anywhere in the codebase.

2. **Server-Side Processing**: All Excel file processing is done server-side using `exceljs` (ExcelJS), which is:
   - Already in `server/package.json` dependencies
   - Actively maintained and secure
   - Used in `server/src/services/excel-export.ts` and `server/src/services/excel-import.ts`

3. **Frontend Only Handles File Uploads**: The frontend components (`components/admin/bulk-excel-export.tsx` and `components/admin/bulk-excel-import.tsx`) only:
   - Handle file uploads via FormData
   - Display file extensions (`.xlsx`, `.xls`) in UI strings
   - Do NOT process Excel files client-side

## Changes Made

1. **Removed from `package.json`:**
   - `xlsx: ^0.18.5`
   - `@types/xlsx: ^0.0.35`

2. **Verified No Usage:**
   - No imports of `xlsx` or `XLSX` found in codebase
   - All Excel processing uses `exceljs` on server

## Verification

After removal, run:
```bash
npm audit
```

The vulnerability should no longer appear.

## Impact

✅ **No Breaking Changes**: The package was unused, so removing it has no functional impact.

✅ **Security Improved**: Eliminates high-severity vulnerabilities.

✅ **No Code Changes Required**: All Excel functionality continues to work via server-side `exceljs`.

## Notes

- The server-side `exceljs` library is secure and actively maintained
- All Excel file operations are processed server-side, which is more secure
- Frontend only handles file uploads/downloads, not file parsing

